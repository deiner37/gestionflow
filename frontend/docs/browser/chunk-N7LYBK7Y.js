import{a as k,b as U,c as V,d as A,e as T,f as N,g as J,h as D,i as W,j as q,k as be,l as L,m as j,n as K,o as _e}from"./chunk-JWW2Z6QR.js";import{A as le,D as u,G as l,I as n,J as i,K as H,L as _,M as v,N as m,O as Q,P as r,Q as b,R as I,S as se,T as f,U as h,V as x,X as w,Y as me,Z as ue,a as P,b as ce,da as F,ea as M,fa as pe,ga as C,k as Y,l as de,n as G,o as oe,oa as ge,pa as ve,q as p,qa as z,r as g,ta as ae,ua as E,w as a,y as S,z as y}from"./chunk-WLZOE7EK.js";var Se=()=>["/home"],ye=()=>["/home/products"],Me=()=>["/home/invoices"],Pe=()=>["/home/users"];function Ie(s,t){s&1&&(n(0,"li",5)(1,"a",6),r(2,"User Manager"),i()()),s&2&&(a(),l("routerLink",w(1,Pe)))}var X=class s{authService=oe(E);router=oe(ve);constructor(){}ngOnInit(){let t=this}logout(){this.authService.logout(),this.router.navigate(["/login"])}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=y({type:s,selectors:[["app-home"]],decls:21,vars:7,consts:[["contentContainer",""],[1,"sidebar","bg-dark","text-white","p-3",2,"width","250px","height","100vh","position","fixed","top","0","left","0","z-index","1000"],[1,"sidebar-header","mb-4"],[1,"text-center"],[1,"nav","flex-column"],[1,"nav-item","mb-2"],["href","#",1,"nav-link","text-white",3,"routerLink"],["class","nav-item mb-2",4,"ngIf"],[1,"nav-link","text-white",3,"click"],[1,"content-container",2,"margin-left","250px","padding","20px","z-index","1"]],template:function(e,o){if(e&1){let c=_();n(0,"nav",1)(1,"div",2)(2,"h5",3),r(3,"GestioFlow"),i()(),n(4,"ul",4)(5,"li",5)(6,"a",6),r(7,"Dashboard"),i()(),n(8,"li",5)(9,"a",6),r(10,"Products"),i()(),n(11,"li",5)(12,"a",6),r(13,"Invoices"),i()(),u(14,Ie,3,2,"li",7),n(15,"li",5)(16,"a",8),v("click",function(){return p(c),g(o.logout())}),r(17,"Logout"),i()()()(),n(18,"div",9,0),H(20,"router-outlet"),i()}e&2&&(a(6),l("routerLink",w(4,Se)),a(3),l("routerLink",w(5,ye)),a(3),l("routerLink",w(6,Me)),a(2),l("ngIf",o.authService.isAdmin()))},dependencies:[C,M,ge,z],styles:[".sidebar[_ngcontent-%COMP%]{transition:all .3s ease}.sidebar[_ngcontent-%COMP%]:hover{width:260px}ul.nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}ul.nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.content-container[_ngcontent-%COMP%]{background-color:#f8f9fa;min-height:100vh}.card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f5f7fa)}.btn-primary[_ngcontent-%COMP%], .btn-success[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s}.btn-primary[_ngcontent-%COMP%]:hover, .btn-success[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}"]})};var we=()=>["/home/products"],Ee=()=>["/home/invoices"],Oe=()=>["/home/users"];function Fe(s,t){s&1&&(n(0,"div",8)(1,"div",16)(2,"div",10)(3,"h5",11),r(4,"Usuarios"),i(),n(5,"p",12),r(6,"Gestionar usuarios y roles del sistema."),i(),n(7,"a",13),r(8,"Ir a Usuarios"),i()()()()),s&2&&(a(7),l("routerLink",w(1,Oe)))}var ee=class s{constructor(t){this.authService=t}ngOnInit(){console.log("Dashboard Component started")}static \u0275fac=function(e){return new(e||s)(S(E))};static \u0275cmp=y({type:s,selectors:[["app-dashboard"]],decls:31,vars:6,consts:[[1,"dashboard-container","container","py-5"],[1,"row","justify-content-center"],[1,"col-md-10"],[1,"card","shadow-lg","mb-4",2,"border-radius","15px"],[1,"card-body","text-center","p-5"],[1,"card-title","mb-3",2,"color","#2c3e50"],[1,"card-text","mb-4",2,"color","#7f8c8d"],[1,"row","row-cols-1","row-cols-md-2","g-4"],[1,"col"],[1,"card","h-100","border-0","bg-primary","text-white",2,"background-color","#3498db","border-radius","10px"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["href","#",1,"btn","btn-light",3,"routerLink"],[1,"card","h-100","border-0","bg-success","text-white",2,"background-color","#27ae60","border-radius","10px"],["class","col",4,"ngIf"],[1,"card","h-100","border-0","bg-info","text-white",2,"background-color","#2980b9","border-radius","10px"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),r(6,"Dashboard de Gesti\xF3n"),i(),n(7,"p",6),r(8),H(9,"br"),r(10," Bienvenido al centro de control. Aqu\xED puedes supervisar usuarios, productos y facturas. Usa el men\xFA lateral para navegar. "),i(),n(11,"div",7)(12,"div",8)(13,"div",9)(14,"div",10)(15,"h5",11),r(16,"Productos"),i(),n(17,"p",12),r(18,"Ver y gestionar productos disponibles."),i(),n(19,"a",13),r(20,"Ir a Productos"),i()()()(),n(21,"div",8)(22,"div",14)(23,"div",10)(24,"h5",11),r(25,"Facturas"),i(),n(26,"p",12),r(27,"Generar y revisar facturas de clientes."),i(),n(28,"a",13),r(29,"Ir a Facturas"),i()()()(),u(30,Fe,9,2,"div",15),i()()()()()()),e&2&&(a(8),I(" \xA1Hola, ",o.authService.isAuthenticated()?o.authService.getRole()==="admin"?"admin":"usuario":"","!"),a(11),l("routerLink",w(4,we)),a(9),l("routerLink",w(5,Ee)),a(2),l("ngIf",o.authService.isAdmin()))},dependencies:[C,M,z],styles:[".dashboard-container[_ngcontent-%COMP%]{background-color:#f8f9fa;min-height:100vh}.card[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 5px 15px #0003}.bg-primary[_ngcontent-%COMP%], .bg-success[_ngcontent-%COMP%], .bg-info[_ngcontent-%COMP%]{transition:background-color .3s ease}.bg-primary[_ngcontent-%COMP%]:hover, .bg-success[_ngcontent-%COMP%]:hover, .bg-info[_ngcontent-%COMP%]:hover{opacity:.9}.btn-light[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ffffff;color:#2c3e50}"]})};var R=class s{constructor(t){this.api=t}getProducts(){return this.api.get("/products")}getProduct(t){return this.api.get(`/products/${t}`)}createProduct(t){return this.api.post("/products",t)}updateProduct(t,e){return this.api.put(`/products/${t}`,e)}deleteProduct(t){return this.api.delete(`/products/${t}`)}static \u0275fac=function(e){return new(e||s)(G(K))};static \u0275prov=Y({token:s,factory:s.\u0275fac,providedIn:"root"})};function Ue(s,t){if(s&1&&(n(0,"div",34),r(1),i()),s&2){let e=m();a(),b(e.errorMessage)}}function Ve(s,t){if(s&1){let e=_();n(0,"button",35),v("click",function(){p(e);let c=m();return g(c.cancelEdit())}),r(1," Cancel "),i()}}function Ae(s,t){if(s&1){let e=_();n(0,"tr")(1,"td"),r(2),i(),n(3,"td"),r(4),i(),n(5,"td"),r(6),i(),n(7,"td"),r(8),i(),n(9,"td"),r(10),i(),n(11,"td")(12,"div",27)(13,"button",36),v("click",function(){let c=p(e).$implicit,d=m();return g(d.editProduct(c))}),r(14," Edit "),i(),n(15,"button",37),v("click",function(){let c=p(e).$implicit,d=m();return g(d.deleteProduct(c._id))}),r(16," Delete "),i()()()()}if(s&2){let e=t.$implicit;a(2),b(e.name),a(2),b(e.description),a(2),I("$",e.price,""),a(2),b(e.stock),a(2),b(e.status)}}var te=class s{constructor(t){this.productsService=t}products=[];productForm={name:"",description:"",price:0,stock:0,status:"active"};selectedProduct=null;errorMessage="";ngOnInit(){this.loadProducts()}loadProducts(){this.productsService.getProducts().subscribe(t=>{this.products=t},t=>{this.errorMessage="Error: "+t.message})}addProduct(){this.productsService.createProduct(this.productForm).subscribe(t=>{this.products.push(t),this.resetForm(),this.errorMessage=""},t=>{this.errorMessage="Error: "+t.message})}editProduct(t){this.selectedProduct=P({},t),this.productForm=P({},t)}updateProduct(){this.selectedProduct&&this.selectedProduct._id&&this.productsService.updateProduct(this.selectedProduct._id,this.productForm).subscribe(t=>{let e=this.products.findIndex(o=>o._id===t._id);e!==-1&&(this.products[e]=t),this.resetForm(),this.selectedProduct=null,this.errorMessage=""},t=>{this.errorMessage="Error: "+t.message})}deleteProduct(t){confirm("\xBFAre you sure?")&&this.productsService.deleteProduct(t).subscribe(()=>{this.products=this.products.filter(e=>e._id!==t),this.errorMessage=""},e=>{this.errorMessage="Error: "+e.message})}cancelEdit(){this.selectedProduct=null,this.resetForm()}resetForm(){this.productForm={name:"",description:"",price:0,stock:0,status:"active"}}static \u0275fac=function(e){return new(e||s)(S(R))};static \u0275cmp=y({type:s,selectors:[["app-products"]],decls:68,vars:9,consts:[[1,"products-container","container","py-5"],[1,"row","justify-content-center"],[1,"col-md-10"],[1,"card","shadow-lg","mb-4",2,"border-radius","15px"],[1,"card-body","p-4"],[1,"card-title","mb-4","text-center",2,"color","#2c3e50"],["class","alert alert-danger mb-4",4,"ngIf"],[1,"card","mb-4",2,"border-radius","10px"],[1,"card-body","p-3"],[1,"card-title","mb-3"],["novalidate","",1,"needs-validation",3,"ngSubmit"],[1,"row","g-3"],[1,"col-md-6"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","price",1,"form-label"],["type","number","id","price","name","price","required","","step","0.01",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-12"],["for","description",1,"form-label"],["id","description","name","description","required","","rows","3",1,"form-control",3,"ngModelChange","ngModel"],["for","stock",1,"form-label"],["type","number","id","stock","name","stock","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","status",1,"form-label"],["id","status","name","status","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","active"],["value","inactive"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary",2,"background-color","#3498db","border","none"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],[1,"card",2,"border-radius","10px"],[1,"table","table-striped","table-hover"],[2,"background-color","#2c3e50","color","white"],[4,"ngFor","ngForOf"],[1,"alert","alert-danger","mb-4"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"btn","btn-warning",2,"background-color","#f1c40f","border","none",3,"click"],[1,"btn","btn-danger",2,"background-color","#e74c3c","border","none",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),r(6,"Manage Products"),i(),u(7,Ue,2,1,"div",6),n(8,"div",7)(9,"div",8)(10,"h5",9),r(11,"Add/Edit Product"),i(),n(12,"form",10),v("ngSubmit",function(){return o.selectedProduct?o.updateProduct():o.addProduct()}),n(13,"div",11)(14,"div",12)(15,"div",13)(16,"label",14),r(17,"Name"),i(),n(18,"input",15),x("ngModelChange",function(d){return h(o.productForm.name,d)||(o.productForm.name=d),d}),i()()(),n(19,"div",12)(20,"div",13)(21,"label",16),r(22,"Price"),i(),n(23,"input",17),x("ngModelChange",function(d){return h(o.productForm.price,d)||(o.productForm.price=d),d}),i()()(),n(24,"div",18)(25,"div",13)(26,"label",19),r(27,"Description"),i(),n(28,"textarea",20),x("ngModelChange",function(d){return h(o.productForm.description,d)||(o.productForm.description=d),d}),i()()(),n(29,"div",12)(30,"div",13)(31,"label",21),r(32,"Stock"),i(),n(33,"input",22),x("ngModelChange",function(d){return h(o.productForm.stock,d)||(o.productForm.stock=d),d}),i()()(),n(34,"div",12)(35,"div",13)(36,"label",23),r(37,"Status"),i(),n(38,"select",24),x("ngModelChange",function(d){return h(o.productForm.status,d)||(o.productForm.status=d),d}),n(39,"option",25),r(40,"Active"),i(),n(41,"option",26),r(42,"Inactive"),i()()()(),n(43,"div",27)(44,"button",28),r(45),i(),u(46,Ve,2,0,"button",29),i()()()()(),n(47,"div",30)(48,"div",8)(49,"h5",9),r(50,"Existing Products"),i(),n(51,"table",31)(52,"thead")(53,"tr",32)(54,"th"),r(55,"Name"),i(),n(56,"th"),r(57,"Description"),i(),n(58,"th"),r(59,"Price"),i(),n(60,"th"),r(61,"Stock"),i(),n(62,"th"),r(63,"Status"),i(),n(64,"th"),r(65,"Actions"),i()()(),n(66,"tbody"),u(67,Ae,17,5,"tr",33),i()()()()()()()()()),e&2&&(a(7),l("ngIf",o.errorMessage),a(11),f("ngModel",o.productForm.name),a(5),f("ngModel",o.productForm.price),a(5),f("ngModel",o.productForm.description),a(5),f("ngModel",o.productForm.stock),a(5),f("ngModel",o.productForm.status),a(7),I(" ",o.selectedProduct?"Update":"Add"," Product "),a(),l("ngIf",o.selectedProduct),a(21),l("ngForOf",o.products))},dependencies:[C,F,M,j,N,W,q,k,J,D,U,V,L,T,A],styles:[".products-container[_ngcontent-%COMP%]{background-color:#f8f9fa;min-height:100vh}.card[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 5px 15px #0003}.form-control[_ngcontent-%COMP%]:focus{border-color:#3498db;box-shadow:0 0 5px #3498db80}.btn-primary[_ngcontent-%COMP%], .btn-warning[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s}.btn-primary[_ngcontent-%COMP%]:hover, .btn-warning[_ngcontent-%COMP%]:hover, .btn-danger[_ngcontent-%COMP%]:hover, .btn-secondary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.table-striped[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e9ecef;cursor:pointer}.table-striped[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#2c3e50!important;color:#fff!important}"]})};var ne=class s{constructor(t){this.api=t}createInvoice(t){return this.api.post("/invoices",t)}getInvoice(t){return this.api.get(`/invoices/${t}`)}getUserPurchasesLastMonth(){return this.api.get("/invoices/user/purchases/last-month")}getInvoices(){return this.api.get("/invoices")}updateInvoice(t,e){return this.api.put(`/invoices/${t}`,e)}deleteInvoice(t){return this.api.delete(`/invoices/${t}`)}getInvoicesForUser(t){return this.api.get(`/invoices?userId=${t}`)}static \u0275fac=function(e){return new(e||s)(G(K))};static \u0275prov=Y({token:s,factory:s.\u0275fac,providedIn:"root"})};function Ne(s,t){if(s&1&&(n(0,"div",15),r(1),i()),s&2){let e=m();a(),b(e.errorMessage)}}function De(s,t){if(s&1&&(n(0,"option",35),r(1),i()),s&2){let e=t.$implicit;l("value",e._id),a(),se("",e.name," (Price: $",e.price,")")}}function We(s,t){if(s&1){let e=_();n(0,"div",25)(1,"div",26)(2,"div",27)(3,"label",28),r(4,"Product ID"),i(),n(5,"select",29),x("ngModelChange",function(c){let d=p(e).index,B=m(2);return h(B.invoiceForm.products[d].productId,c)||(B.invoiceForm.products[d].productId=c),g(c)}),n(6,"option",30),r(7,"Select a product"),i(),u(8,De,2,3,"option",31),i()(),n(9,"div",27)(10,"label",28),r(11,"Quantity"),i(),n(12,"input",32),x("ngModelChange",function(c){let d=p(e).index,B=m(2);return h(B.invoiceForm.products[d].quantity,c)||(B.invoiceForm.products[d].quantity=c),g(c)}),i()(),n(13,"div",33)(14,"button",34),v("click",function(){let c=p(e).index,d=m(2);return g(d.removeProductFromInvoice(c))}),r(15," Remove "),i()()()()}if(s&2){let e=t.index,o=m(2);a(3),l("for","productId"+e),a(2),l("id","productId"+e),f("ngModel",o.invoiceForm.products[e].productId),l("name","productId"+e),a(3),l("ngForOf",o.products),a(2),l("for","quantity"+e),a(2),l("id","quantity"+e),f("ngModel",o.invoiceForm.products[e].quantity),l("name","quantity"+e),a(2),l("disabled",o.invoiceForm.products.length<=1)}}function qe(s,t){if(s&1){let e=_();n(0,"div",16)(1,"div",10)(2,"h5",11),r(3,"Generate Invoice"),i(),n(4,"form",17,0),v("ngSubmit",function(){p(e);let c=m();return g(c.addInvoice())}),n(6,"div",18)(7,"div",19)(8,"h6",20),r(9,"Products"),i(),u(10,We,16,10,"div",21),n(11,"button",22),v("click",function(){p(e);let c=m();return g(c.addProductToInvoice())}),r(12," Add Product "),i()(),n(13,"div",23)(14,"button",24),r(15," Add Invoice "),i()()()()()()}if(s&2){let e=Q(5),o=m();a(10),l("ngForOf",o.invoiceForm.products),a(4),l("disabled",!e.valid)}}function Le(s,t){if(s&1&&(n(0,"li"),r(1),i()),s&2){let e=t.$implicit;a(),se("",e.name," (Qty: ",e.quantity,")")}}function je(s,t){if(s&1){let e=_();n(0,"button",39),v("click",function(){p(e);let c=m(2).$implicit,d=m();return g(d.deleteInvoice(c._id))}),r(1," Delete "),i()}}function Re(s,t){if(s&1&&(n(0,"div",23),u(1,je,2,0,"button",38),i()),s&2){let e=m(2);a(),l("ngIf",e.authService.isAdmin())}}function Be(s,t){if(s&1&&(n(0,"tr")(1,"td"),r(2),i(),n(3,"td")(4,"ul",36),u(5,Le,2,2,"li",14),i()(),n(6,"td"),r(7),i(),n(8,"td"),r(9),i(),n(10,"td"),r(11),me(12,"date"),i(),n(13,"td"),u(14,Re,2,1,"div",37),i()()),s&2){let e=t.$implicit,o=m();a(2),b(e.username),a(3),l("ngForOf",e.products),a(2),b(o.calculateTotalQuantity(e.products)),a(2),I("$",e.total||o.calculateTotal(e.products),""),a(2),b(ue(12,6,e.date,"medium")),a(3),l("ngIf",o.authService.isAdmin())}}var ie=class s{constructor(t,e,o){this.invoicesService=t;this.authService=e;this.productsService=o}invoices=[];invoiceForm={userId:"",username:"",products:[],total:0,date:new Date};selectedInvoice=null;errorMessage="";products=[];ngOnInit(){this.loadInvoices(),this.loadProducts()}loadProducts(){this.productsService.getProducts().subscribe(t=>{this.products=t},t=>{this.errorMessage="Error loading products: "+t.message})}loadInvoices(){if(this.authService.isAdmin())this.invoicesService.getInvoices().subscribe(t=>{this.invoices=t},t=>{this.errorMessage="Error loading invoices: "+t.message});else{let t=this.authService.getUserId();t&&this.invoicesService.getInvoicesForUser(t).subscribe(e=>{this.invoices=e},e=>{this.errorMessage="Error loading invoices: "+e.message})}}addInvoice(){if(this.authService.isAdmin())this.errorMessage="Administrators cannot create invoices directly.";else{let t=this.authService.getUserData();if(!t)throw"User not found";this.invoiceForm.userId=t.id,this.invoiceForm.username=t.name,this.invoicesService.createInvoice(this.invoiceForm).subscribe(e=>{this.invoices.push(e),this.resetForm(),this.errorMessage=""},e=>{this.errorMessage="Error creating invoice: "+e.message})}}editInvoice(t){this.selectedInvoice=P({},t),this.invoiceForm=P({},t)}deleteInvoice(t){this.authService.isAdmin()?confirm("Are you sure you want to delete this invoice?")&&this.invoicesService.deleteInvoice(t).subscribe(()=>{this.invoices=this.invoices.filter(e=>e._id!==t),this.errorMessage=""},e=>{this.errorMessage="Error deleting invoice: "+e.message}):this.errorMessage="Only administrators can delete invoices."}addProductToInvoice(){this.invoiceForm.products||(this.invoiceForm.products=[]),this.invoiceForm.products.push({productId:"",quantity:0,price:0,name:""})}removeProductFromInvoice(t){this.invoiceForm.products&&this.invoiceForm.products.length>1&&this.invoiceForm.products.splice(t,1)}resetForm(){this.invoiceForm={userId:"",username:"",products:[],total:0,date:new Date}}calculateTotal(t){return t.reduce((e,o)=>e+o.quantity*o.price,0)}calculateTotalQuantity(t){return t?t.reduce((e,o)=>e+(o.quantity||0),0):0}static \u0275fac=function(e){return new(e||s)(S(ne),S(E),S(R))};static \u0275cmp=y({type:s,selectors:[["app-invoices"]],decls:30,vars:3,consts:[["invoiceFormData","ngForm"],[1,"invoices-container","container","py-5"],[1,"row","justify-content-center"],[1,"col-md-10"],[1,"card","shadow-lg","mb-4",2,"border-radius","15px"],[1,"card-body","p-4"],[1,"card-title","mb-4","text-center",2,"color","#2c3e50"],["class","alert alert-danger mb-4",4,"ngIf"],["class","card mb-4","style","border-radius: 10px;",4,"ngIf"],[1,"card",2,"border-radius","10px"],[1,"card-body","p-3"],[1,"card-title","mb-3"],[1,"table","table-striped","table-hover"],[2,"background-color","#2c3e50","color","white"],[4,"ngFor","ngForOf"],[1,"alert","alert-danger","mb-4"],[1,"card","mb-4",2,"border-radius","10px"],["novalidate","",1,"needs-validation",3,"ngSubmit"],[1,"row","g-3"],[1,"col-md-12"],[1,"mb-2"],["formArrayName","products",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary","mb-3",2,"background-color","#3498db","border","none",3,"click"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary",2,"background-color","#3498db","border","none",3,"disabled"],["formArrayName","products"],[1,"row","mb-3"],[1,"col-md-5"],[1,"form-label",3,"for"],["required","",1,"form-control",3,"ngModelChange","id","ngModel","name"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","number","required","","min","1",1,"form-control",3,"ngModelChange","id","ngModel","name"],[1,"col-md-2","d-flex","align-items-end"],["type","button",1,"btn","btn-danger",2,"background-color","#e74c3c","border","none",3,"click","disabled"],[3,"value"],[1,"list-unstyled"],["class","d-flex gap-2",4,"ngIf"],["class","btn btn-danger","style","background-color: #e74c3c; border: none;",3,"click",4,"ngIf"],[1,"btn","btn-danger",2,"background-color","#e74c3c","border","none",3,"click"]],template:function(e,o){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h2",6),r(6,"Manage Invoices"),i(),u(7,Ne,2,1,"div",7)(8,qe,16,2,"div",8),n(9,"div",9)(10,"div",10)(11,"h5",11),r(12,"Existing Invoices"),i(),n(13,"table",12)(14,"thead")(15,"tr",13)(16,"th"),r(17,"User"),i(),n(18,"th"),r(19,"Products"),i(),n(20,"th"),r(21,"Quantity"),i(),n(22,"th"),r(23,"Total"),i(),n(24,"th"),r(25,"Date"),i(),n(26,"th"),r(27,"Actions"),i()()(),n(28,"tbody"),u(29,Be,15,9,"tr",14),i()()()()()()()()()),e&2&&(a(7),l("ngIf",o.errorMessage),a(),l("ngIf",!o.authService.isAdmin()),a(21),l("ngForOf",o.invoices))},dependencies:[C,F,M,pe,j,N,W,q,k,J,D,U,V,L,be,T,A],styles:[".invoices-container[_ngcontent-%COMP%]{background-color:#f8f9fa;min-height:100vh}.card[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 5px 15px #0003}.form-control[_ngcontent-%COMP%]:focus{border-color:#3498db;box-shadow:0 0 5px #3498db80}.btn-primary[_ngcontent-%COMP%], .btn-warning[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s}.btn-primary[_ngcontent-%COMP%]:hover, .btn-warning[_ngcontent-%COMP%]:hover, .btn-danger[_ngcontent-%COMP%]:hover, .btn-secondary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.table-striped[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e9ecef;cursor:pointer}.table-striped[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#2c3e50!important;color:#fff!important}"]})};function Ye(s,t){if(s&1&&(n(0,"div",14),r(1),i()),s&2){let e=m();a(),b(e.errorMessage)}}function Ge(s,t){if(s&1){let e=_();n(0,"div",18)(1,"div",19)(2,"label",30),r(3,"Role"),i(),n(4,"select",31),x("ngModelChange",function(c){p(e);let d=m(2);return h(d.userForm.role,c)||(d.userForm.role=c),g(c)}),n(5,"option",32),r(6,"User"),i(),n(7,"option",33),r(8,"Admin"),i()()()()}if(s&2){let e=m(2);a(4),f("ngModel",e.userForm.role)}}function He(s,t){if(s&1){let e=_();n(0,"button",34),v("click",function(){p(e);let c=m(2);return g(c.cancelEdit())}),r(1," Cancel "),i()}}function Qe(s,t){if(s&1){let e=_();n(0,"div",15)(1,"div",10)(2,"h5",11),r(3),i(),n(4,"form",16,0),v("ngSubmit",function(){p(e);let c=m();return g(c.selectedUser?c.updateUser():c.addUser())}),n(6,"div",17)(7,"div",18)(8,"div",19)(9,"label",20),r(10,"Name"),i(),n(11,"input",21),x("ngModelChange",function(c){p(e);let d=m();return h(d.userForm.name,c)||(d.userForm.name=c),g(c)}),i()()(),n(12,"div",18)(13,"div",19)(14,"label",22),r(15,"Email"),i(),n(16,"input",23),x("ngModelChange",function(c){p(e);let d=m();return h(d.userForm.email,c)||(d.userForm.email=c),g(c)}),i()()(),n(17,"div",18)(18,"div",19)(19,"label",24),r(20,"Password"),i(),n(21,"input",25),x("ngModelChange",function(c){p(e);let d=m();return h(d.userForm.password,c)||(d.userForm.password=c),g(c)}),i()()(),u(22,Ge,9,1,"div",26),n(23,"div",27)(24,"button",28),r(25),i(),u(26,He,2,0,"button",29),i()()()()()}if(s&2){let e=Q(5),o=m();a(3),b(o.selectedUser?"Edit User":"Add User"),a(8),f("ngModel",o.userForm.name),a(5),f("ngModel",o.userForm.email),a(5),f("ngModel",o.userForm.password),l("required",!o.selectedUser),a(),l("ngIf",o.authService.isAdmin()),a(2),l("disabled",!e.valid),a(),I(" ",o.selectedUser?"Update":"Add"," User "),a(),l("ngIf",o.selectedUser)}}function ze(s,t){if(s&1){let e=_();n(0,"button",40),v("click",function(){p(e);let c=m().$implicit,d=m(2);return g(d.deleteUser(c._id))}),r(1," Delete "),i()}}function Je(s,t){if(s&1){let e=_();n(0,"tr")(1,"td"),r(2),i(),n(3,"td"),r(4),i(),n(5,"td"),r(6),i(),n(7,"td")(8,"div",27)(9,"button",38),v("click",function(){let c=p(e).$implicit,d=m(2);return g(d.editUser(c))}),r(10," Edit "),i(),u(11,ze,2,0,"button",39),i()()()}if(s&2){let e=t.$implicit,o=m(2);a(2),b(e.name),a(2),b(e.email),a(2),b(e.role),a(3),l("disabled",!o.authService.isAdmin()&&o.authService.getUserId()!==e._id),a(2),l("ngIf",o.authService.isAdmin())}}function Ke(s,t){if(s&1&&(n(0,"table",35)(1,"thead")(2,"tr",36)(3,"th"),r(4,"Name"),i(),n(5,"th"),r(6,"Email"),i(),n(7,"th"),r(8,"Role"),i(),n(9,"th"),r(10,"Actions"),i()()(),n(11,"tbody"),u(12,Je,12,5,"tr",37),i()()),s&2){let e=m();a(12),l("ngForOf",e.users)}}function Xe(s,t){s&1&&(n(0,"p",41),r(1,"No users found."),i())}var re=class s{constructor(t,e){this.usersService=t;this.authService=e}users=[];userForm={name:"",email:"",password:"",role:"user"};selectedUser=null;errorMessage="";ngOnInit(){this.loadUsers()}loadUsers(){if(this.authService.isAdmin())this.usersService.getUsers().subscribe(t=>{this.users=t},t=>{this.errorMessage="Error loading users: "+(t.error?.message||t.message)});else{let t=this.authService.getUserId();t&&this.usersService.getUser(t).subscribe(e=>{this.users=[e]},e=>{this.errorMessage="Error loading user profile: "+(e.error?.message||e.message)})}}addUser(){this.authService.isAdmin()?this.usersService.createUser(this.userForm).subscribe(t=>{this.users.push(t),this.resetForm(),this.errorMessage=""},t=>{this.errorMessage="Error creating user: "+(t.error?.message||t.message)}):this.errorMessage="Only administrators can create users."}editUser(t){this.authService.isAdmin()||this.authService.getUserId()===t._id?(this.selectedUser=P({},t),this.userForm=ce(P({},t),{password:""})):this.errorMessage="You do not have permission to edit this user."}updateUser(){this.selectedUser&&this.selectedUser._id&&(this.authService.isAdmin()||this.authService.getUserId()===this.selectedUser._id?this.usersService.updateUser(this.selectedUser._id,this.userForm).subscribe(t=>{let e=this.users.findIndex(o=>o._id===t._id);e!==-1&&(this.users[e]=t),this.resetForm(),this.selectedUser=null,this.errorMessage=""},t=>{this.errorMessage="Error updating user: "+(t.error?.message||t.message)}):this.errorMessage="Only administrators or the user themselves can update this user.")}deleteUser(t){this.authService.isAdmin()&&confirm("Are you sure you want to delete this user?")?this.usersService.deleteUser(t).subscribe(()=>{this.users=this.users.filter(e=>e._id!==t),this.errorMessage=""},e=>{this.errorMessage="Error deleting user: "+(e.error?.message||e.message)}):this.errorMessage="Only administrators can delete users."}cancelEdit(){this.selectedUser=null,this.resetForm()}resetForm(){this.userForm={name:"",email:"",password:"",role:"user"}}static \u0275fac=function(e){return new(e||s)(S(_e),S(E))};static \u0275cmp=y({type:s,selectors:[["app-users"]],decls:15,vars:4,consts:[["userFormData","ngForm"],[1,"users-container","container","py-5"],[1,"row","justify-content-center"],[1,"col-md-10"],[1,"card","shadow-lg","mb-4",2,"border-radius","15px"],[1,"card-body","p-4"],[1,"card-title","mb-4","text-center",2,"color","#2c3e50"],["class","alert alert-danger mb-4",4,"ngIf"],["class","card mb-4","style","border-radius: 10px;",4,"ngIf"],[1,"card",2,"border-radius","10px"],[1,"card-body","p-3"],[1,"card-title","mb-3"],["class","table table-striped table-hover",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"alert","alert-danger","mb-4"],[1,"card","mb-4",2,"border-radius","10px"],["novalidate","",1,"needs-validation",3,"ngSubmit"],[1,"row","g-3"],[1,"col-md-6"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","email",1,"form-label"],["type","email","id","email","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","id","password","name","password",1,"form-control",3,"ngModelChange","ngModel","required"],["class","col-md-6",4,"ngIf"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary",2,"background-color","#3498db","border","none",3,"disabled"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["for","role",1,"form-label"],["id","role","name","role","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","user"],["value","admin"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"table","table-striped","table-hover"],[2,"background-color","#2c3e50","color","white"],[4,"ngFor","ngForOf"],[1,"btn","btn-warning",2,"background-color","#f1c40f","border","none",3,"click","disabled"],["class","btn btn-danger","style","background-color: #e74c3c; border: none;",3,"click",4,"ngIf"],[1,"btn","btn-danger",2,"background-color","#e74c3c","border","none",3,"click"],[1,"text-center"]],template:function(e,o){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h2",6),r(6,"Manage Users"),i(),u(7,Ye,2,1,"div",7)(8,Qe,27,9,"div",8),n(9,"div",9)(10,"div",10)(11,"h5",11),r(12,"User List"),i(),u(13,Ke,13,1,"table",12)(14,Xe,2,0,"p",13),i()()()()()()()),e&2&&(a(7),l("ngIf",o.errorMessage),a(),l("ngIf",o.authService.isAdmin()||o.selectedUser),a(5),l("ngIf",o.users.length>0),a(),l("ngIf",o.users.length===0))},dependencies:[C,F,M,j,N,W,q,k,D,U,V,L,T,A],styles:[".users-container[_ngcontent-%COMP%]{background-color:#f8f9fa;min-height:100vh}.card[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 5px 15px #0003}.form-control[_ngcontent-%COMP%]:focus{border-color:#3498db;box-shadow:0 0 5px #3498db80}.btn-primary[_ngcontent-%COMP%], .btn-warning[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s}.btn-primary[_ngcontent-%COMP%]:hover, .btn-warning[_ngcontent-%COMP%]:hover, .btn-danger[_ngcontent-%COMP%]:hover, .btn-secondary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.table-striped[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e9ecef;cursor:pointer}.table-striped[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#2c3e50!important;color:#fff!important}.alert-danger[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}"]})};var Ze=[{path:"",component:X,children:[{path:"",component:ee},{path:"products",component:te},{path:"invoices",component:ie},{path:"users",component:re}]}],Ce=class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=le({type:s});static \u0275inj=de({imports:[C,ae.forChild(Ze),ae]})};export{Ce as HomeModule};
